!function(e){"use strict";function t(e){this.area=e,this.input=e.querySelector(".pure-droploader"),this.input=this.input||e.querySelector("input[type=file]"),this.init()}t.prototype.init=function(){pureDroploader&&(this.dispatch("pureDroploaderInit",{droploader:this}),["dragenter","dragover"].forEach(function(e){this.area.addEventListener(e,function(e){e.preventDefault(),e.stopPropagation(),this.area.classList.add("hover")}.bind(this),!1)},this),["dragleave","drop"].forEach(function(e){this.area.addEventListener(e,function(e){e.preventDefault(),e.stopPropagation(),this.area.classList.remove("hover")}.bind(this),!1)},this),this.area.addEventListener("drop",function(e){this.files(e.dataTransfer.files)}.bind(this),!1),this.input.addEventListener("change",function(e){this.files(e.target.files)}.bind(this),!1),this.dispatch("pureDroploaderReady",{droploader:this}))},t.prototype.files=function(e){this.dispatch("pureDroploaderFiles",{droploader:this,files:e});for(let t=0,o=e.length;t<o;t++)this.upload(e[t]),this.preview(e[t])},t.prototype.upload=function(e){let t=new FormData;t.append("file",e),this.dispatch("pureDroploaderUpload",{droploader:this,file:e,formdata:t}),this.wpRest(t,function(t,o){this.dispatch("pureDroploaderUploaded",{droploader:this,file:e,status:t,response:o})})},t.prototype.preview=function(e){const t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){let o=this.area.querySelector("picture.preview"),r=this.area.querySelector("img.preview");o&&((r=o.querySelector("img")).classList.add("preview"),o.parentNode.insertBefore(r,o),o.parentNode.removeChild(o),o=null),r||((r=document.createElement("img")).classList.add("preview"),this.area.insertBefore(r,this.area.firstChild||null)),this.dispatch("pureDroploaderPreview",{droploader:this,file:e,reader:t,image:r}),r.src=t.result}.bind(this)},t.prototype.dispatch=function(e,t){this.area.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:t}))},t.prototype.wpAjax=function(e,t,o){const r=new XMLHttpRequest;t.append("action",e),r.open("POST",pureDroploader.wpAjax||"/wp-admin/admin-ajax.php"),r.send(t),r.onload=function(){o.call(this,r.status,r.responseText)}.bind(this)},t.prototype.wpRest=function(e,t){const o=new XMLHttpRequest;o.open("POST",pureDroploader.wpRest||"/wp-json/wp/v2/media/"),o.setRequestHeader("X-WP-Nonce",pureDroploader.wpNonce),o.setRequestHeader("Accept","application/json"),o.send(e),o.onload=function(){t.call(this,o.status,o.responseText)}.bind(this)},Object.defineProperty(t,"auto",{configurable:!0,value:function(){document.querySelectorAll(".pure-droploader-area").forEach(function(e){new t(e)})}}),Object.defineProperty(t,"ready",{configurable:!0,value:function(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}}),"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:null};var o=document.createEvent("CustomEvent");return o.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o}),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),e.Droploader=t,e.Droploader.ready(e.Droploader.auto)}(window.pure=window.pure||{});